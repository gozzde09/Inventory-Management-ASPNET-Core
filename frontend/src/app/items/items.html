<div class="container mt-4">
  <div class="d-flex justify-content-between align-items-center mb-3">
    <h2>Lagerhantering</h2>
  </div>

  <!-- Skapa nytt item -->
  <form class="row g-2 mb-4" (ngSubmit)="addItem()" #itemForm="ngForm">
    <div class="col-md-4">
      <input
        class="form-control"
        placeholder="Namn"
        [(ngModel)]="newItem.name"
        name="name"
        required
      />
    </div>
    <div class="col-md-2">
      <input
        type="number"
        class="form-control"
        placeholder="Mängd"
        [(ngModel)]="newItem.quantity"
        name="quantity"
        required
        min="0"
      />
    </div>
    <div class="col-md-2">
      <input
        class="form-control"
        placeholder="Enhet"
        [(ngModel)]="newItem.unit"
        name="unit"
        required
      />
    </div>
    <div class="col-md-2">
      <button class="btn btn-success w-100" type="submit" [disabled]="!itemForm.valid">
        Lägg till
      </button>
    </div>
  </form>

  <!-- Items -->
  <p class="text-muted">Totalt {{ items.length }} artikel(ar)</p>

  <!-- Tabell -->
  <table class="table table-striped table-bordered">
    <thead class="table-dark">
      <tr>
        <th>#</th>
        <th>Namn</th>
        <th>Mängd</th>
        <th>Enhet</th>
        <th>Åtgärder</th>
      </tr>
    </thead>
    <tbody>
      @for (item of items(); track item.id) {
      <tr>
        <td>{{ item.id }}</td>
        <!-- Edit-läge -->
        @if (editId === item.id) {
        <td>
          <input [(ngModel)]="editItem.name" class="form-control" name="editName" />
        </td>
        <td>
          <input
            type="number"
            [(ngModel)]="editItem.quantity"
            class="form-control"
            name="editQuantity"
            min="0"
          />
        </td>
        <td>
          <input [(ngModel)]="editItem.unit" class="form-control" name="editUnit" />
        </td>
        <td>
          <button class="btn btn-success btn-sm me-2" (click)="saveEdit(item)">Spara</button>
          <button class="btn btn-secondary btn-sm" (click)="cancelEdit()">Avbryt</button>
        </td>
        } @else {
        <!-- Läs-läge -->
        <td>{{ item.name }}</td>
        <td>{{ item.quantity }}</td>
        <td>{{ item.unit }}</td>
        <td>
          <button class="btn btn-warning btn-sm me-2" (click)="startEdit(item)">Redigera</button>
          <button class="btn btn-danger btn-sm" (click)="deleteItem(item)">Ta bort</button>
        </td>
        }
      </tr>
      } @empty {
      <tr>
        <td colspan="5" class="text-center text-muted">Inga artiklar hittades</td>
      </tr>
      }
    </tbody>
  </table>
</div>
