<!-- Add new item -->
<form class="row g-2 mb-4" (ngSubmit)="addItem()" #itemForm="ngForm">
  <div class="col-12 col-sm-6 col-md-3">
    <label for="name" class="form-label">Artikelnamn</label>
    <input
      id="name"
      class="form-control"
      placeholder="Munskydd "
      [(ngModel)]="newItem.name"
      name="name"
      required
    />
    @if(!newItem.name){
    <div class="text-danger small mt-1">Namn är obligatoriskt.</div>
    } @else if (itemExists(newItem.name)) {
    <div class="text-danger small mt-1">Artikeln finns redan.</div>
    }
  </div>

  <div class="col-12 col-sm-6 col-md-3">
    <label for="quantity" class="form-label">Antal</label>
    <input
      id="quantity"
      type="text"
      class="form-control"
      placeholder="0"
      [(ngModel)]="newItem.quantity"
      name="quantity"
      required
      pattern="^[0-9]+$"
    />
    @if (!newItem.quantity) {
    <div class="text-danger small mt-1">Antal är obligatoriskt.</div>
    } @else if( newItem.quantity==0) {
    <div class="text-danger small mt-1">Antal får inte vara null.</div>
    } @else if( newItem.quantity<0) {
    <div class="text-danger small mt-1">Antal får inte vara negativt.</div>
    } @else if (newItem.quantity && !newItem.quantity.toString().match('^[0-9]+$')) {
    <div class="text-danger small mt-1">Antal får bara innehålla siffror.</div>
    }
  </div>

  <div class="col-12 col-sm-6 col-md-3">
    <label for="unit" class="form-label">Enhet</label>
    <input
      id="unit"
      class="form-control"
      placeholder="Ex: st, flaska"
      [(ngModel)]="newItem.unit"
      name="unit"
      required
      pattern="^[^\d]+$"
    />
    @if (!newItem.unit) {
    <div class="text-danger small mt-1">Enhet är obligatoriskt.</div>
    } @else if ( newItem.unit && !newItem.unit.match('^[^\\d]+$')) {
    <div class="text-danger small mt-1">Enhet får inte innehålla siffror.</div>
    }
  </div>

  <div class="col-12 col-sm-6 col-md-3 text-nowrap">
    <label for="threshold" class="form-label">
      Minsta lagernivå
      <i
        class="bi bi-info-circle ms-0 text-blue mb-3"
        ngbTooltip="Varningsgräns: När lagret når denna nivå bör varning skickas."
        style="cursor: pointer"
      ></i
    ></label>
    <input
      id="threshold"
      type="text"
      class="form-control"
      placeholder="Varningsgräns"
      [(ngModel)]="newItem.criticalStockThreshold"
      name="threshold"
      required
      pattern="^[0-9]+$"
    />
    @if (!newItem.criticalStockThreshold) {
    <div class="text-danger small mt-1">Minsta lagernivå är obligatoriskt.</div>
    } @else if( newItem.criticalStockThreshold==0) {
    <div class="text-danger small mt-1">Minsta lagernivå får inte vara null.</div>
    } @else if( newItem.criticalStockThreshold<0) {
    <div class="text-danger small mt-1">Minsta lagernivå får inte vara negativt.</div>
    } @else if (newItem.criticalStockThreshold &&
    !newItem.criticalStockThreshold.toString().match('^[0-9]+$')) {
    <div class="text-danger small mt-1">Minsta lagernivå får bara innehålla siffror.</div>
    }
  </div>

  <div class="col-md-12 d-flex align-items-end justify-content-end mt-2">
    <button
      class="btn btn-success me-2"
      type="submit"
      [disabled]="!itemForm.valid || itemExists(newItem.name)"
    >
      Lägg till
    </button>
    <button class="btn btn-outline-secondary" (click)="closeAddForm()" type="button">Avbryt</button>
  </div>
</form>
